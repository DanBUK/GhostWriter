<!DOCTYPE html>
<html>
    <head>
        <title>Choose Blog</title>
        <!-- TODO import these fonts to app so that the app doesn't have to download them every time-->
        <link rel="stylesheet" type='text/css' href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700'>
        <!-- TODO clean up this stylesheet, not everything is used -->
        <link rel="stylesheet" href="css/choose_blog.css">

        <!-- include source files here... -->
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
        <script type="text/javascript" src="js/jquery.cookie.js"></script>

        <script type="text/javascript">
            function check_blog_url(url) {
              $.get('http://www.corsproxy.com/'+url+'/ghost/signin/')
                .success(function(result) {
                  $.cookie('blog_adress', url);
                  window.location = "http://"+url+"/ghost/signin?chosenblog=true";
                })
                .fail(function(result) {
                  document.getElementById("notifications").style.visibility="visible";
                });
            }
        </script>
    </head>
    <body class="ghost-login" style="">
        <main role="main" id="main">
            <aside id="notifications" style="visibility: hidden;">
                <div class="js-bb-notification" style="display: block; height: auto;">
                    <section class="notification-error notification-passive js-notification">
                        No such Ghost blog, check your url
                        <a class="close" href="#"><span class="hidden">Close</span></a>
                    </section>
                </div>
            </aside>
            <section class="login-box js-login-box" style="opacity: 1;">
                <form id="login" >
                    <div class="url-wrap">
                        <input id="url" class="url" type="text" placeholder="Your Ghost blog web adress" name="url" autocapitalize="off" autocorrect="off">
                    </div>
                    <button class="button-save" type="submit" >Go</button>
                </form>
            </section>
        </main>
        <script>
            // Override the default submit functionality in favour of custom code
            $('#login').submit(function() {
              check_blog_url(document.getElementById('url').value);
              return false;
            });
            // Make sure that the X closes the error notification
            $('.close').click(function(){
              document.getElementById("notifications").style.visibility="hidden";
            });
        </script>
    </body>
</html>
